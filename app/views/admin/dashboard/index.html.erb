<h1>Admin Dashboard</h1>
<h4> <%= link_to "Edit Profile", edit_user_path(current_user) %></h4>
<%= link_to "View Your Items", admin_items_path %>

<h3>Orders by Status</h3>
<table>
  <th>Status</th>
  <th>Count of Orders</th>
  <% @orders_by_status.each do |status, count| %>
  <tr>
    <td><%= status %></td>
    <td><%= count %></td>
  </tr>
  <% end %>
</table>

<h3>Orders</h3>
<%= form_tag admin_dashboard_path, method: :get do %>
  <%= label_tag "Filter" %>
  <%= select_tag :status, options_for_select(@statuses, params[:status]) %>
  <%= submit_tag "Apply" %>
<% end %>
<table class="all-orders">
  <th>Order ID</th>
  <th>Status</th>
  <th></th>
  <th></th>
  <% @orders.each do |order| %>
  <tr id=<%= order.id %>>
      <td><%= link_to order.id, order_path(order) %></td>
      <td><%= order.status %></td>
    <% if order.status == "Ordered" %>
      <td><%= button_to "mark as paid", order_path(order, status: "Paid"), method: :put%></td>
      <td><%= button_to "cancel", order_path(order, status: "Cancelled"), method: :put %></td>
    <% elsif order.status == "Paid" %>
      <td><%= button_to "mark as completed", order_path(order, status: "Completed"), method: :put%>%></td>
      <td><%= button_to "cancel", order_path(order, status: "Cancelled"), method: :put %> %></td>
    <% else %>
      <td></td>
      <td></td>
    <% end %>
  </tr>
  <% end %>
</table>
